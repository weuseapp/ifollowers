/** layui-admin.std-v1.4.0 LPPL License By https://www.layui.com/layuiadmin/ */
 ;"use strict";layui.define(["table","form","op_common","laydate","echartsTheme","admin"],function(e){function t(){setCacheData("apiLists",o)}var a=layui.$,i=layui.table,n=layui.form,l=layui.laydate,d=layui.admin,r=window.echarts,s=getUrlParams(location.search),o=layui.api.analysis_get_install_analysis;s.app_id&&(o+="?app_id="+s.app_id),n.on("submit(search)",function(e){t(),window.data=e.data,i.reload("lists",{where:e.field,page:{curr:1},done:null})}),a(".op-methods").on("click",function(e){t(),window.data=e.data;var n=a(this).data("type");window[n]&&window[n].call(this,e.data,i.cache["extends"])}),i.on("tool(lists)",function(e){t(),window.data=e.data,window[e.event]&&window[e.event].call(this,e.data,i.cache["extends"])}),i.render({elem:"#lists",url:o,headers:{token:layui.data(layui.setter.tableName).user.token},parseData:function(e){return window.parent.listData=e,checkApiStatusByData(e),m(e.data),getListsFormatByData(e)},cols:[[{type:"numbers",width:90,title:"序号",sort:!0},{field:"app_name",title:"应用名称"},{field:"device_type",title:"设备类型",templet:"#tpl_device_type",align:"center"},{field:"channel",title:"应用渠道"},{field:"quantity",title:"日安装量"},{field:"amount",title:"累计安装量"},{field:"user_quantity",title:"日新增用户"},{field:"user_amount",title:"累计用户"},{field:"date",title:"统计日期",sort:!0}]],limit:1e3,done:function(e){i.cache["extends"]=e["extends"],initSearchInput(e["extends"])}}),window.initSearchInput=function(e){renderSelectV2("app_id","app_id",e.apps,null,"全部"),renderSelectV2("device_type","device_type",e.device_type,null,"全部"),renderSelectV2("channel","channel",e.channel,null,"全部"),n.render()},l.render({elem:"#range_at",range:"~",trigger:"click",max:-1,done:function(e){var t={start_date:"",end_date:""};if(!e)return void n.val("form",t);var a=e.split(" ~ ");return 2!==a.length?(n.val("form",t),void layer.msg("时间格式有误，请检查",{icon:5})):(t.start_date=a[0],t.end_date=a[1],void n.val("form",t))}});var c=document.getElementById("LAY-index-dataview"),u={legend_data:{"安装量":!0,"累计安装量":!1,"新增用户":!1,"累计用户":!1}},p={title:{text:"App 安装统计"},tooltip:{trigger:"axis"},legend:{data:u.legend_data?Object.keys(u.legend_data):[],selected:u.legend_data},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},toolbox:{feature:{saveAsImage:{}}},xAxis:{type:"category",boundaryGap:!1},yAxis:{type:"value"},series:[{name:"安装量",type:"line",data:[]},{name:"累计安装量",type:"line",data:[]},{name:"新增用户",type:"line",data:[]},{name:"累计用户",type:"line",data:[]}]},y=layui.echartsTheme;y.line.smooth=!1;var m=function(e){var t=r.init(c,y);if(e){p.xAxis.data=e.date_rang?e.date_rang:[];for(var a in p.series)p.series.hasOwnProperty(a)&&(p.series[a].data=e.chart_data[p.series[a].name])}t.setOption(p),d.resize(function(){t.resize()})};d.on("side",function(){setTimeout(function(){m()},300)}),e("analysis_install"),e("const",{DEVICE_TYPE_ANDROID:1,DEVICE_TYPE_IOS:2,DEVICE_TYPE_PC:3})});