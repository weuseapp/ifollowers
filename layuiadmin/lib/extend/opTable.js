/** layui-admin.std-v1.4.0 LPPL License By https://www.layui.com/layuiadmin/ */
 ;"use strict";layui.define(["form","table"],function(e){var n=layui.$,i=layui.table,o=1.3,l="on",t="off",a="status",p=0,r=1,s=2,d=3,c="-1",u="0",f={index:layui.opTable?layui.opTable.index+1e4:0,set:function(e){var i=this;return i.config=n.extend({},i.config,e),i}},m={},v=function(e,n){return e.replace("#","").replace(".","")+(n?"opTable-i-table-open":"")},b=function(e){return v(e,!0)+"-all"},T=function(e,n,i){return e?"":'<i class="opTable-i-table-open '+b(n)+' " '+a+'="off"  title="(展开|关闭)全部" '+i+"></i>"},h=function(){var e=this,i=e.config;i.id||i.index;return{reload:function(i){return i=i||{},e.config=n.extend(e.config,i),!i.page&&e.config.table.config.page&&(e.config.page.limit=e.config.table.config.page.limit,e.config.page.curr=e.config.table.config.page.curr),e.render(),this},config:i,openAll:function(){if(this.isOpenAll())return this;var i=e.config.openType;return e.config.openType=s,n("."+v(e.config.elem,!0)).parent().click(),e.config.openType=i,n("."+b(e.config.elem)).addClass("opTable-open-dow").removeClass("opTable-open-up").attr(a,l),e.config.onOpenAll&&e.config.onOpenAll(),this},closeAll:function(){if(!this.isOpenAll())return this;var i=e.config.openType;return e.config.openType=d,n("."+v(e.config.elem,!0)).parent().click(),e.config.openType=i,n("."+b(e.config.elem)).addClass("opTable-open-up").removeClass("opTable-open-dow").attr(a,t),e.config.onCloseAll&&e.config.onCloseAll(),this},openIndex:function(i){var o=n("."+v(e.config.elem,!0)).eq(i);if(o.length<=0)return!1;var t=o.attr(a);return t===l||(o.click(),!0)},closeIndex:function(i){var o=n("."+v(e.config.elem,!0)).eq(i);if(o.length<=0)return!1;var l=o.attr(a);return l===t||(o.click(),!0)},toggleOpenIndex:function(i){var o=n("."+v(e.config.elem,!0)).eq(i);return!(o.length<=0)&&(o.parent().click(),!0)},isOpenAll:function o(){var i=n("."+v(e.config.elem,!0)),o=[];return i.each(function(e){i.eq(e).hasClass("opTable-open-dow")&&o.push(!0)}),i.length===o.length}}},g=function(e){var i=this;return i.index=++f.index,i.config=n.extend({},i.config,f.config,e),i.render(),this};g.prototype.config={openVisible:!0,isOpenAllClick:!0,openType:p,opOrientation:"v",openColumnIndex:0,isAloneColumn:!0,openIcon:{},table:null,childTable:null,slideDownTime:200,slideUpTime:100},g.prototype.render=function(){function e(){f.openVisible&&(n("."+v(f.elem,!0)).parent().unbind("click").click(function(e){function i(){f.onClose&&f.onClose(w,x),f.childTable=null}function o(){R.empty().append('<div class="opTable-network-message" ><i class="layui-icon layui-icon-loading layui-icon layui-anim layui-anim-rotate layui-anim-loop" data-anim="layui-anim-rotate layui-anim-loop"></i></div>'),T.addTR.find("div").slideDown(f.slideDownTime),y.onNetwork(w,function(e){y.openCols.forEach(function(n,i){c(n,e)}),R.empty().append(N.join("")),u(e)},function(e){R.empty().append("<div class='opTable-reload opTable-network-message' style='text-align: center;margin-top: 20px'>"+(e||"没有数据")+"</div>"),n(".opTable-reload").unbind().click(function(e){o()})})}function c(e,n){if(e.templet)N.push("<div id='"+e.field+"' class='opTable-open-item-div "+A+"' index='"+x+"' opOrientation='"+f.opOrientation+"'>"),N.push(e.templet(n)),N.push("</div>");else if(e.type&&"select"===e.type){var i=["<div id='"+e.field+"' class='opTable-open-item-div "+A+"' index='"+x+"' opOrientation='"+f.opOrientation+"' >"];i.push("<span style='color: #99a9bf'>"+e.title+"：</span>"),i.push("<div class='layui-input-inline'><select  lay-filter='"+e.field+"'>"),e.items(n).forEach(function(e){i.push("<option value='"+e.id+"' "),i.push(e.isSelect?" selected='selected' ":""),i.push(" >"+e.value+"</option>")}),i.push("</select></div>"),i.push("</div>"),N.push(i.join("")),setTimeout(function(){layui.form.render(),layui.form.on("select("+e.field+")",function(i){if(f.onEdit&&e.isEdit&&e.isEdit(i,n)){var o={};o.value=i.value,o.field=e.field,n[e.field]=i.value,o.data=JSON.parse(JSON.stringify(n)),f.onEdit(o)}})},20)}else{var o=e.onDraw?e.onDraw(n):n[e.field];o=o||"",N.push("<div id='"+e.field+"' class='opTable-open-item-div "+A+"' index='"+x+"' opOrientation='"+f.opOrientation+"'>"),N.push("<span class='opTable-item-title'>"+e.title+"：</span>"),N.push(e.edit?"<input  class='opTable-exp-value opTable-exp-value-edit' autocomplete='off' name='"+e.field+"' value='"+o+"'/>":"<span class='opTable-exp-value' >"+o+"</span>"),N.push("</div>")}}function u(e){n(".opTable-exp-value-edit").unbind("blur").blur(function(){var i=n(this),o=i.attr("name"),l=i.val();if(f.onEdit&&e[o]+""!==l){var t={};t.value=i.val(),t.field=i.attr("name"),e[o]=l,t.data=e,f.onEdit(t)}}).keypress(function(e){13===e.which&&n(this).blur()})}layui.stope(e);var b=n(this).children(),T=this,x=parseInt(b.attr("data")),w=m[b.attr("elem")][x],I="on"===b.attr(a),k=b.parent().parent().parent().parent().find(".opTable-open-dow"),D=b.parent().parent().parent().parent().find(".opTable-open-td"),A=f.elem.replace("#","").replace(".","")+"-opTable-open-item-div";if(f.openType===d)return k.addClass("opTable-open-up").removeClass("opTable-open-dow").attr(a,t),D.slideUp(f.slideUpTime,function(){D.remove()}),void i();if(f.openType===s)k.addClass("opTable-open-dow").removeClass("opTable-open-up").attr(a,l),I&&T.addTR.remove();else if(f.openType===p){var O=k.attr(a),E=b.attr("data")===k.attr("data");if(k.addClass("opTable-open-up").removeClass("opTable-open-dow").attr(a,t),O===l&&E)return void D.slideUp(f.slideUpTime,function(){D.remove(),i()});b.attr(a,t),D.remove()}else if(f.openType===r&&I)return b.removeClass("opTable-open-dow"),b.attr(a,t),void this.addTR.find("div").eq(0).slideUp(f.slideUpTime,function(){T.addTR.remove(),i()});this.addTR=n(["<tr><td class='opTable-open-td'  colspan='"+(h.length+(f.isAloneColumn?1:0))+"'>","<div style='margin-left: 50px;display: none'></div>","</td></tr>"].join(""));var R=T.addTR.children().children();b.parent().parent().parent().after(this.addTR);var N=[];if(y)o();else if(C){if("function"!=typeof C)throw"OPTable: openTable attribute is function ";var S=C(w);S.layuiDone=S.done,S.done=function(e,i,o){n(".opTable-open-td tr").hover(function(e){layui.stope(e)}),S.layuiDone&&S.layuiDone(e,i,o)};var U=S.elem.replace("#","").replace(".","");R.empty().append("<table id='"+U+"' lay-filter='"+U+"'></table>").css({padding:"0 10px 0 50px","margin-left":"0",width:T.addTR.width()}).fadeIn(400),D.css("cssText","background-color:#FCFCFC!important"),f.childTable=layui.table.render(S)}else g.forEach(function(e,n){c(e,w)}),R.append(N.join("")),this.addTR.find("div").slideDown(f.slideDownTime),u(w);f.onItemClick&&n("."+A).unbind("click").click(function(e){var i=n(this).attr("id"),o=m[v(f.elem,!1)][n(this).attr("index")];f.onItemClick({lineData:o,field:i,value:o[i],div:n(this),e:e})}),b.addClass("opTable-open-dow"),b.attr(a,l),f.onInitSuccess&&f.onInitSuccess(w,x,this.addTR),setTimeout(function(){f.onOpen&&f.onOpen(w,x,this.addTR)},f.slideDownTime)}),n("."+b(f.elem)).parent().parent().unbind("click").click(function(){if(f.isOpenAllClick){var e=n(this).find("i").eq(0),i=e.attr(a);i===l?(e.addClass("opTable-open-up").removeClass("opTable-open-dow").attr(a,t),f.thisIns.closeAll()):(e.addClass("opTable-open-dow").removeClass("opTable-open-up").attr(a,l),f.thisIns.openAll())}}))}var o=this,f=o.config,h=f.cols[0],g=f.openCols||[],y=f.openNetwork||null,C=f.openTable||null;f.layuiDone=f.done||f.layuiDone,h.forEach(function(e,n){e.isOpenCol&&(f.isAloneColumn?h.splice(n,1):e.title=e.opDefTitle||e.title)}),f.openColumnIndex=f.openColumnIndex>h.length?h.length:f.openColumnIndex,delete f.done;var x=function(){var e=f.openIcon[c];return e?"style='background: url("+e+") 0 0 no-repeat'":""},w=function(){var e=f.openIcon[u];return e?"style='background: url("+e+") 0 0 no-repeat'":""},I=function(e){var n=f.openIcon[e+""];return n?"style='background: url("+n+") 0 0 no-repeat'":w};if(f.openVisible)if(f.isAloneColumn)h.splice(f.openColumnIndex,0,{width:50,isOpenCol:!0,title:T(!f.isOpenAllClick,f.elem,x()),templet:function(e){var n=v(f.elem,!1);return m[n]=m[n]||{},m[n][e.LAY_INDEX]=e,"<i class='opTable-i-table-open "+n+"opTable-i-table-open' "+a+"='off'  data='"+e.LAY_INDEX+" ' elem='"+n+"' title='展开' "+I(e.LAY_INDEX)+"></i>"}});else{var k=h[f.openColumnIndex];delete k.edit,k.opDefTitle=k.title,k.isOpenCol=!0,k.title=T(k.sort,f.elem,x())+"<span class='opTable-span-seize'></span>"+k.title,k.templet=function(e){var n=v(f.elem,!1);return m[n]=m[n]||{},m[n][e.LAY_INDEX]=e,"<i class='opTable-i-table-open "+n+"opTable-i-table-open' "+a+"='off'  data='"+e.LAY_INDEX+" ' elem='"+n+"' title='展开' "+I(e.LAY_INDEX)+"></i><span class='opTable-span-seize'></span>"+(k.onDraw?k.onDraw(e):e[k.field])}}f.table=i.render(n.extend({done:function(n,i,o){e(),f.layuiDone&&f.layuiDone(n,i,o)}},f));var D=n(f.elem).attr("lay-filter");i.on("sort("+D+")",function(n){f.onSort&&f.onSort(n),e()}),layui.table.on("edit("+D+")",function(e){n(this).parents(".opTable-open-td").length>0||f.onEdit&&f.onEdit(e)})},f.render=function(e){var n=new g(e),i=h.call(n);return n.config.thisIns=i,i},layui.link(layui.cache.base+"style/opTable.css?v=1"+o,function(){},"opTable"),e("opTable",f)});