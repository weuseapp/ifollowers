/** layui-admin.std-v1.4.0 LPPL License By https://www.layui.com/layuiadmin/ */
 ;"use strict";layui.define(["jquery","laytpl"],function(i){function n(i){if(!i)throw new Error("菜单条目内必须填写内容。");if("hr"===i)return"hr";if(0!==i.indexOf("{"))throw new Error("除了分割线hr，别的菜单条目都必须保证是合格的Javascript对象或json对象。");return new Function("return "+i)()}function t(i){if(i&&0<i.length){for(var n=0,t=new Array(i.length),o=0;o<i.length;o++)for(var e=i[o],d=0;d<e.length;d++)e[d].header&&e[d].fixed&&(n++,t[o]=e[d],e.splice(d,1),d--);if(0<n)return t}return null}function o(i,n){"string"==typeof i&&(i=d(i)),this.$dom=i,this.option=d.extend({downid:String(Math.random()).split(".")[1],filter:i.attr("lay-filter")},w,n),20<this.option.gap&&(this.option.gap=20),this.init()}function e(i,n){d(i||"[lay-"+c+"]").each(function(){var i=d(this),t=new Function("return "+(i.attr("lay-"+c)||"{}"))();i.removeAttr("lay-"+c);var e=i.data(c)||new o(i,d.extend({},t,n||{}));i.data(c,e)})}var d=layui.jquery||layui.$,s=layui.laytpl,r="a",a={},l="1",p="2",h="3",c=window.MICROANSWER_DROPDOWAN||"dropdown",u="<div tabindex='0' class='layui-anim layui-anim-upbit dropdown-root' "+c+"-id='{{d.downid}}' style='display: none;z-index: {{d.zIndex}}'>{{# if (d.arrow){ }}<div class='dropdown-pointer'></div>{{# } }}<div class='dropdown-content' style='margin: {{d.gap}}px {{d.gap}}px;background-color: {{d.backgroundColor}};min-width: {{d.minWidth}}px;max-width: {{d.maxWidth}}px;min-height: {{d.minHeight}}px;max-height: {{d.maxHeight}}px;white-space: {{d.nowrap?\"nowrap\":\"normal\"}}'>",m="</div></div>",f=u+"<div class='dropdown-content-table' cellpadding='0' cellspacing='0'>{{# if (d.fixHeaders && d.fixHeaders.length > 0){ }}<div class='dropdown-content-thead'><div class='dropdown-content-tr'>{{# layui.each(d.fixHeaders, function(i, fixHeader){ }}{{# if (fixHeader) { }}<div class='dropdown-content-th'><div class='dropdown-menu-fixed-head {{(d.menuSplitor && i < (d.menus.length-1))?\"menu-splitor\":\"\"}}'><div class='menu-fixed-head' style='text-align: {{fixHeader.align||\"center\"}}'>{{fixHeader.header}}</div></div></div>{{# } else { }}<th><div class='dropdown-menu-fixed-head {{(d.menuSplitor && i < (d.menus.length-1))?\"menu-splitor\":\"\"}}'><div class='menu-fixed-head'>&nbsp;</div></div></th>{{# } }}{{# }); }}</div></div>{{# } }}<div class='dropdown-content-tbody'><div class='dropdown-content-tr'>{{# layui.each(d.menus, function(i, menu){ }}<div class='dropdown-content-td' valign='top'><div class='dropdown-menu-wrap {{(d.menuSplitor && i < (d.menus.length-1))?\"menu-splitor\":\"\"}} overflowauto' style='min-height: {{d.minHeight}}px;max-height: {{d.maxHeight - ((d.fixHeaders)?24:0)}}px;'><ul class='dropdown-menu' style=''>{{# layui.each(menu, function(index, item){ }}<li class='menu-item-wrap {{(d.fixHeaders && d.fixHeaders.length) > 0?\"nomargin\":\"\"}}'>{{# if ('hr' === item) { }}<hr>{{# } else if (item.header) { }}{{# if (item.withLine) { }}<fieldset class=\"layui-elem-field layui-field-title menu-header withLine\"><legend>{{item.header}}</legend></fieldset>{{# } else { }}<div class='menu-header' style='text-align: {{item.align||\"left\"}}'>{{item.header}}</div>{{# } }}{{# } else { }}<div class='menu-item'><a href='javascript:;' lay-event='{{item.event}}'>{{# if (item.layIcon){ }}<i class='layui-icon {{item.layIcon}}'></i>&nbsp;{{# } }}<span class='{{item.txtClass||\"\"}}'>{{item.txt}}</span></a></div>{{# } }}</li>{{# }); }}</ul></div></div>{{#});}}</div></div></div>"+m,w={menus:[],templateMenu:"",template:"",showBy:"click",align:"left",minWidth:80,maxWidth:500,minHeight:10,maxHeight:400,zIndex:891,gap:8,onHide:function(i,n){},onShow:function(i,n){},scrollBehavior:"follow",backgroundColor:"#FFF",cssLink:"https://cdn.jsdelivr.net/gh/microanswer/layui_dropdown@2.3.2/dist/dropdown.css",immed:!1,arrow:!0,templateMenuSptor:"[]",menuSplitor:!0};window[c+"_useOwnCss"]||layui.link(window[c+"_cssLink"]||w.cssLink,function(){},c+"_css"),o.prototype.init=function(){var i=this,o=!1;if(i.option.menus&&0<i.option.menus.length){o=!0;var e=i.option.menus[0];Array.isArray(e)||(i.option.menus=[i.option.menus]),i.option.fixHeaders=t(i.option.menus),i.option.nowrap=!0,s(f).render(i.option,function(n){i.downHtml=n,i.initEvent()})}else if(i.option.templateMenu){var r;o=!0,r=-1===i.option.templateMenu.indexOf("#")?"#"+i.option.templateMenu:i.option.templateMenu;var a=d.extend(d.extend({},i.option),i.option.data||{});s(d(r).text()).render(a,function(o){i.option.menus=function(i,t){if(!i)return"";if(!t)throw new Error("请指定菜单模板限定符。");for(var o,e,d=t.charAt(0),s=t.charAt(1),r=i.length,a=0,c=l,u=!1,m=[];a<r;){var f=i.charAt(a);c!==l||u?c!==p||u?c===h&&(u?(e.srcStr+=f,u=!1):"\\"===f?u=!0:f===s?(e=n(e.srcStr),o.push(e),c=p):e.srcStr+=f):d===f?(e={srcStr:""},c=h):s===f&&(c=l):d===f&&(o=[],m.push(o),c=p),a+=1}return m}(o,i.option.templateMenuSptor),i.option.fixHeaders=t(i.option.menus),i.option.nowrap=!0,s(f).render(i.option,function(n){i.downHtml=n,i.initEvent()})})}else if(i.option.template){var c;o=!0,c=-1===i.option.template.indexOf("#")?"#"+i.option.template:i.option.template,(a=d.extend(d.extend({},i.option),i.option.data||{})).nowrap=!1,s(u+d(c).html()+m).render(a,function(n){i.downHtml=n,i.initEvent()})}else layui.hint().error("下拉框目前即没配置菜单项，也没配置下拉模板。[#"+(i.$dom.attr("id")||"")+",filter="+i.option.filter+"]");o&&this.option.immed&&this.downHtml&&this.show()},o.prototype.initSize=function(){if(this.$down&&(this.$down.find(".dropdown-pointer").css({width:2*this.option.gap,height:2*this.option.gap}),!this._sized)){var i=0;this.$down.find(".dropdown-menu-wrap").each(function(){i=Math.max(i,d(this).height())}),this.$down.find(".dropdown-menu-wrap").css({height:i}),this._sized=!0}},o.prototype.initPosition=function(){if(this.$down){var i,n,t,o,e=this.$dom.offset(),d=this.$dom.outerHeight(),s=this.$dom.outerWidth(),r=e.left,a=e.top-window.pageYOffset,l=this.$down.outerHeight(),p=this.$down.outerWidth();n=d+a,(i="right"===this.option.align?r+s-p+this.option.gap:"center"===this.option.align?r+(s-p)/2:r-this.option.gap)+p>=window.innerWidth&&(i=window.innerWidth-p-2*this.option.gap),t=i<r?s<p?r-i+s/2:p/2:s<p?i+(r+s-i)/2:p/2,t-=this.option.gap;var h=this.$arrowDom;o=-this.option.gap,h.css("left",t),h.css("right","unset"),n+l>=window.innerHeight?(n=a-l,o=l-this.option.gap,h.css("top",o).addClass("bottom")):h.css("top",o).removeClass("bottom"),this.$down.css("left",i),this.$down.css("top",n)}},o.prototype.show=function(){var i,n,t=this,o=!1;t.$down||(t.$down=d(t.downHtml),t.$dom.after(t.$down),t.$arrowDom=t.$down.find(".dropdown-pointer"),o=!0),t.initPosition(),t.opening=!0,setTimeout(function(){t.$down.focus()},100),t.$down.addClass("layui-show"),t.initSize(),t.opened=!0,o&&t.initDropdownEvent(),i=t,n=a[r]||[],d.each(n,function(n,t){t(i)}),o&&t.onSuccess(),t.option.onShow&&t.option.onShow(t.$dom,t.$down)},o.prototype.hide=function(){this.opened&&(this.fcd=!1,this.$down.removeClass("layui-show"),this.opened=!1,this.option.onHide&&this.option.onHide(this.$dom,this.$down))},o.prototype.hideWhenCan=function(){this.mic||this.opening||this.fcd||this.hide()},o.prototype.toggle=function(){this.opened?this.hide():this.show()},o.prototype.onSuccess=function(){this.option.success&&this.option.success(this.$down)},o.prototype._onScroll=function(){var i=this;i.opened&&("follow"===this.option.scrollBehavior?setTimeout(function(){i.initPosition()},1):this.hide())},o.prototype.initEvent=function(){var i,n,t,o=this;n=function(i){i!==o&&o.hide()},(t=a[i=r]||[]).push(n),a[i]=t,d(window).on("scroll",function(){o._onScroll()}),o.$dom.parents().on("scroll",function(){o._onScroll()}),d(window).on("resize",function(){o.opened&&o.initPosition()}),o.initDomEvent()},o.prototype.initDomEvent=function(){var i=this;i.$dom.mouseenter(function(){i.mic=!0,"hover"===i.option.showBy&&(i.fcd=!0,i.show())}),i.$dom.mouseleave(function(){i.mic=!1}),"click"===i.option.showBy&&i.$dom.on("click",function(){i.fcd=!0,i.toggle()}),i.$dom.on("blur",function(){i.fcd=!1,i.hideWhenCan()})},o.prototype.initDropdownEvent=function(){var i=this;i.$down.find(".dropdown-menu-wrap").on("mousewheel",function(n){var t=d(this);(n=n||window.event).cancelable=!0,n.cancelBubble=!0,n.preventDefault(),n.stopPropagation(),n.stopImmediatePropagation&&n.stopImmediatePropagation(),n.returnValue=!1,i.scrolling&&t.finish();var o=-n.originalEvent.wheelDelta||n.originalEvent.detail;0<o?(50<o&&(o=50),i.scrolling=!0,t.animate({scrollTop:t.scrollTop()+o},{duration:170,complete:function(){i.scrolling=!1}})):o<0?(o<-50&&(o=-50),i.scrolling=!0,t.animate({scrollTop:t.scrollTop()+o},{duration:170,complete:function(){i.scrolling=!1}})):i.scrolling=!1}),i.$down.mouseenter(function(){i.mic=!0,i.$down.focus()}),i.$down.mouseleave(function(){i.mic=!1}),i.$down.on("blur",function(){i.fcd=!1,i.hideWhenCan()}),i.$down.on("focus",function(){i.opening=!1}),i.option.menus&&d("["+c+"-id='"+i.option.downid+"']").on("click","a",function(){var n=(d(this).attr("lay-event")||"").trim();n?(layui.event.call(this,c,c+"("+i.option.filter+")",n),i.hide()):layui.hint().error("菜单条目["+this.outerHTML+"]未设置event。")})},e(),i(c,{suite:e,onFilter:function(i,n){layui.onevent(c,c+"("+i+")",function(i){n&&n(i)})},hide:function(i){d(i).each(function(){var i=d(this).data(c);i&&i.hide()})},show:function(i,n){d(i).each(function(){var t=d(this).data(c);t?t.show():(layui.hint().error("警告：尝试在选择器【"+i+"】上进行下拉框show操作，但此选择器对应的dom并没有初始化下拉框。"),(n=n||{}).immed=!0,e(i,n))})},version:"2.3.2"})});